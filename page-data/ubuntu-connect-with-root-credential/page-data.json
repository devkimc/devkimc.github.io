{"componentChunkName":"component---src-templates-blog-template-js","path":"/ubuntu-connect-with-root-credential","result":{"data":{"cur":{"id":"f19dded4-c101-5bb3-bc6e-c0919f94e06c","html":"<h2 id=\"root-ì ‘ì†í•˜ëŠ”-ì´ìœ \" style=\"position:relative;\"><a href=\"#root-%EC%A0%91%EC%86%8D%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0\" aria-label=\"root ì ‘ì†í•˜ëŠ” ì´ìœ  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>root ì ‘ì†í•˜ëŠ” ì´ìœ </h2>\n<p>Ec2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì‹œ ubuntu ê³„ì •ìœ¼ë¡œ ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\níŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ê±°ë‚˜ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•  ë•Œ sudo ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¶ˆí¸í•¨ì„ ì¤„ì´ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.\n<br /></p>\n<h2 id=\"ì„¤ì •ë°©ë²•\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%A0%95%EB%B0%A9%EB%B2%95\" aria-label=\"ì„¤ì •ë°©ë²• permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì„¤ì •ë°©ë²•</h2>\n<h3 id=\"1-ì´ˆê¸°-ë¹„ë°€ë²ˆí˜¸-ì„¤ì •\" style=\"position:relative;\"><a href=\"#1-%EC%B4%88%EA%B8%B0-%EB%B9%84%EB%B0%80%EB%B2%88%ED%98%B8-%EC%84%A4%EC%A0%95\" aria-label=\"1 ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ ì„¤ì • permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ ì„¤ì •</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo passwd\n// ë¹„ë°€ë²ˆí˜¸ ì…ë ¥</code></pre></div>\n<br />\n<h3 id=\"2-ssh-ì„¤ì •\" style=\"position:relative;\"><a href=\"#2-ssh-%EC%84%A4%EC%A0%95\" aria-label=\"2 ssh ì„¤ì • permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. ssh ì„¤ì •</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vi /etc/ssh/sshd_config</code></pre></div>\n<ol>\n<li>\n<p>root ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸ í—ˆìš© ì‹œ\nPermitRootLogin yes</p>\n</li>\n<li>\n<p>root ssh ì ‘ì†ë§Œ í—ˆìš© ì‹œ\nPermitRootLogin prohibit-password</p>\n</li>\n</ol>\n<br />\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">service sshd restart</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">vi root/.ssh/authorized_keys</code></pre></div>\n<p>private key ë‚´ìš© í™•ì¸ ë° ì ‘ì†í•˜ê¸° ìœ„í•œ private key ë¥¼ ì¶”ê°€\nì´ë ‡ê²Œ ì„¤ì •í•˜ë©´ ì ‘ì†ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>\n<h3 id=\"ì—ëŸ¬-ë°œìƒ-ì‹œ\" style=\"position:relative;\"><a href=\"#%EC%97%90%EB%9F%AC-%EB%B0%9C%EC%83%9D-%EC%8B%9C\" aria-label=\"ì—ëŸ¬ ë°œìƒ ì‹œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì—ëŸ¬ ë°œìƒ ì‹œ</h3>\n<blockquote>\n<p>authentication refused: bad ownership or modes for file /root/.ssh/authorized_keys</p>\n</blockquote>\n<p>ubuntu ê³„ì •ìœ¼ë¡œ root ê³„ì •ì˜ ì¸ì¦íŒŒì¼ì„ ìˆ˜ì •ì‹œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ì…ë‹ˆë‹¤.\nroot í´ë”ì˜ íŒŒì¼ì€ root ê³„ì •ìœ¼ë¡œ ì‘ì„± ë° ìˆ˜ì •í•©ë‹ˆë‹¤.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#root-%EC%A0%91%EC%86%8D%ED%95%98%EB%8A%94-%EC%9D%B4%EC%9C%A0\">root ì ‘ì†í•˜ëŠ” ì´ìœ </a></p>\n</li>\n<li>\n<p><a href=\"#%EC%84%A4%EC%A0%95%EB%B0%A9%EB%B2%95\">ì„¤ì •ë°©ë²•</a></p>\n<ul>\n<li><a href=\"#1-%EC%B4%88%EA%B8%B0-%EB%B9%84%EB%B0%80%EB%B2%88%ED%98%B8-%EC%84%A4%EC%A0%95\">1. ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ ì„¤ì •</a></li>\n<li><a href=\"#2-ssh-%EC%84%A4%EC%A0%95\">2. ssh ì„¤ì •</a></li>\n<li><a href=\"#%EC%97%90%EB%9F%AC-%EB%B0%9C%EC%83%9D-%EC%8B%9C\">ì—ëŸ¬ ë°œìƒ ì‹œ</a></li>\n</ul>\n</li>\n</ul>\n</div>","excerpt":"root ì ‘ì†í•˜ëŠ” ì´ìœ  Ec2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì‹œ ubuntu ê³„ì •ìœ¼ë¡œ ì ‘ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\níŒ¨í‚¤ì§€ë¥¼ ì„¤ì¹˜í•˜ê±°ë‚˜ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•  ë•Œ sudo ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¶ˆí¸í•¨ì„ ì¤„ì´ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.\n ì„¤ì •ë°©ë²• 1. ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ ì„¤ì • 2. ssh ì„¤ì • root ë¹„ë°€ë²ˆí˜¸ ë¡œê·¸ì¸ í—ˆìš© ì‹œ\nPermitRootLogin yes root ssh ì ‘ì†ë§Œ í—ˆìš© ì‹œ\nPermitRootLogin prohibit-password private key ë‚´ìš© í™•ì¸ ë° ì ‘ì†í•˜ê¸° ìœ„í•œ private key ë¥¼ ì¶”ê°€\nì´ë ‡ê²Œ ì„¤ì •í•˜ë©´ ì ‘ì†ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤. ì—ëŸ¬ ë°œìƒ ì‹œ authentication refused: bad ownership or modes for file /root/.ssh/authorized_keys ubuntu ê³„ì •ìœ¼ë¡œ root ê³„ì •ì˜ ì¸ì¦íŒŒì¼ì„ ìˆ˜ì •ì‹œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ì…ë‹ˆë‹¤.\nroot í´ë”ì˜ íŒŒì¼ì€ root ê³„ì •ìœ¼ë¡œ ì‘ì„± ë° ìˆ˜ì •í•©ë‹ˆë‹¤. root ì ‘ì†í•˜ëŠ” ì´ìœ  ì„¤ì •ë°©ë²• 1. ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸ ì„¤ì • 2. ssh ì„¤â€¦","frontmatter":{"date":"January 01, 2023","title":"Ubuntu í™˜ê²½ì—ì„œ root ì‚¬ìš©ìë¡œ ssh ì ‘ì†í•˜ê¸°","categories":"ë¸”ë¡œê·¸ server","author":"vvs-kim","emoji":"ğŸ’»"},"fields":{"slug":"/ubuntu-connect-with-root-credential/"}},"next":{"id":"633db344-14f1-5a2f-bc5f-09cb2e435fc9","html":"<h2 id=\"github-action-\" style=\"position:relative;\"><a href=\"#github-action-\" aria-label=\"github action  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>github action ?</h2>\n<p>jenkins ì™€ ë”ë¶ˆì–´ CI/CD êµ¬ì¶•ì„ ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.\ngithub ì—ì„œ ê°€ìƒí™˜ê²½ì„ ì œê³µí•´ì¤ë‹ˆë‹¤.</p>\n<h3 id=\"ì¥ì \" style=\"position:relative;\"><a href=\"#%EC%9E%A5%EC%A0%90\" aria-label=\"ì¥ì  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì¥ì </h3>\n<p>CI ë¥¼ ìœ„í•œ ì¶”ê°€ ì„œë²„ê°€ í•„ìš” ì—†ë‹¤ëŠ” ê²Œ í° ì¥ì ì´ì—ˆìŠµë‹ˆë‹¤.\ngit hook ì— ë”°ë¼ ë°°í¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<h3 id=\"ë‹¨ì \" style=\"position:relative;\"><a href=\"#%EB%8B%A8%EC%A0%90\" aria-label=\"ë‹¨ì  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë‹¨ì </h3>\n<p>ìœ ë£Œ ê³„ì •ì´ ì•„ë‹ˆë¼ì„œ ê·¸ëŸ°ì§€ ëª°ë¼ë„ ë¹Œë“œ ì‹œê°„ì´ ì˜¤ë˜ê±¸ë ¸ìŠµë‹ˆë‹¤.\njenkins ë¡œ ë°°í¬í•  ë•Œ ì´ 20ì´ˆ ì •ë„ ê±¸ë ¸ì—ˆëŠ”ë°, 2ë¶„ ì •ë„ ì†Œìš”ëìŠµë‹ˆë‹¤. (s3 ì—…ë¡œë“œ ê¹Œì§€)</p>\n<br />\n<h2 id=\"ì‹œì‘í•˜ê¸°\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0\" aria-label=\"ì‹œì‘í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì‹œì‘í•˜ê¸°</h2>\n<p>ê³¼ì •ì„ ê°„ë‹¨í•˜ê²Œ ìš”ì•½í•œ ê¸€ì…ë‹ˆë‹¤\në³´ë‹¤ ìƒì„¸í•œ ë‚´ìš©ì€ í•´ë‹¹ ê¸€ì„ ë³´ì‹œëŠ”ê±¸ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.\n<a href=\"https://blog.bespinglobal.com/post/github-action-%EC%9C%BC%EB%A1%9C-ec2-%EC%97%90-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0/\">https://blog.bespinglobal.com/post/github-action-%EC%9C%BC%EB%A1%9C-ec2-%EC%97%90-%EB%B0%B0%ED%8F%AC%ED%95%98%EA%B8%B0/</a></p>\n<br />\n<h3 id=\"1-iam-ì‚¬ìš©ì-ì¶”ê°€\" style=\"position:relative;\"><a href=\"#1-iam-%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%B6%94%EA%B0%80\" aria-label=\"1 iam ì‚¬ìš©ì ì¶”ê°€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. IAM ì‚¬ìš©ì ì¶”ê°€</h3>\n<p>github ì½”ë“œë¥¼ s3 ë¡œ ì—…ë¡œë“œí•˜ê¸° ìœ„í•´ ì¸ì¦ëœ ì‚¬ìš©ìë¼ëŠ” ê²€ì¦í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.</p>\n<blockquote>\n</blockquote>\n<ol>\n<li>AWS - IAM > AWS ìê²© ì¦ëª… ìœ í˜• ì„ íƒ > ì•¡ì„¸ìŠ¤ í‚¤ â€“ í”„ë¡œê·¸ë˜ë° ë°©ì‹ ì•¡ì„¸ìŠ¤</li>\n<li>GIHUB - ìƒì„±í•œ ì•¡ì„¸ìŠ¤ í‚¤ ID ì™€ ë¹„ë°€ ì•¡ì„¸ìŠ¤í‚¤ë¥¼ ìì‹ ì˜ ë ˆí¬ì§€í† ë¦¬ì— ë“±ë¡</li>\n</ol>\n<br />\n<h3 id=\"2-s3-ë²„í‚·-ìƒì„±\" style=\"position:relative;\"><a href=\"#2-s3-%EB%B2%84%ED%82%B7-%EC%83%9D%EC%84%B1\" aria-label=\"2 s3 ë²„í‚· ìƒì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. S3 ë²„í‚· ìƒì„±</h3>\n<p>github ë¡œë¶€í„° ìˆ˜ì‹ ëœ ë¹Œë“œíŒŒì¼(ì••ì¶•í˜•íƒœ)ì„ ì €ì¥í•©ë‹ˆë‹¤.\ní–¥í›„ì— ìŠ¤ëƒ…ìƒ·ìœ¼ë¡œ ë²„ì „ê´€ë¦¬ë¥¼ ìœ„í•´ ì‚¬ìš©í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<p>ec2 ìš© ë²„í‚· ìƒì„±</p>\n</blockquote>\n<br />\n<h3 id=\"3-iam-ì—­í• -ìƒì„±\" style=\"position:relative;\"><a href=\"#3-iam-%EC%97%AD%ED%95%A0-%EC%83%9D%EC%84%B1\" aria-label=\"3 iam ì—­í•  ìƒì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. IAM ì—­í•  ìƒì„±</h3>\n<p>aws ì—ì„œ ìë™ë°°í¬ë¥¼ í•˜ê¸° ìœ„í•´ codedeploy ë¼ëŠ” ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.\nì´ë•Œ, codedeploy ê°€ ec2 ì— ì ‘ê·¼í•´ë„ ë˜ëŠ” ì—­í• (ì„œë¹„ìŠ¤)ì´ ë§ëŠ”ì§€ ê²€ì¦ê¸° ìœ„í•´ ì‚¬ìš©í•©ë‹ˆë‹¤.</p>\n<blockquote>\n<p>AWS - IAM > ì—­í•  > ì‹ ë¢°ê´€ê³„ > ì‹ ë¢° ì •ì±… í¸ì§‘ > ì•„ë˜ì˜ ì½”ë“œ ë³µì‚¬ ë¶™ì—¬ë„£ê¸°</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Principal\": {\n                \"Service\": [\n                    \"ec2.amazonaws.com\",\n                    \"codedeploy.amazonaws.com\"\n                ]\n            },\n            \"Action\": \"sts:AssumeRole\"\n        }\n    ]\n}\n</code></pre></div>\n<br />\n<h3 id=\"4-codedeploy-ë°°í¬-ê·¸ë£¹-ë°-ì• í”Œë¦¬ì¼€ì´ì…˜-ìƒì„±\" style=\"position:relative;\"><a href=\"#4-codedeploy-%EB%B0%B0%ED%8F%AC-%EA%B7%B8%EB%A3%B9-%EB%B0%8F-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%83%9D%EC%84%B1\" aria-label=\"4 codedeploy ë°°í¬ ê·¸ë£¹ ë° ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Codedeploy ë°°í¬ ê·¸ë£¹ ë° ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„±</h3>\n<p>aws ì—ì„œ ì§€ì›í•˜ëŠ” ìë™ë°°í¬ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.\në°°í¬ ì§„í–‰ìƒí™©ì„ ëª¨ë‹ˆí„°ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¬¸ì œê°€ ìƒê¸¸ì‹œ ì¬ì‹œë„ í•˜ê³  ì´ë ¥ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<blockquote>\n<p>AWS - Codedeploy > ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„±</p>\n</blockquote>\n<p>ë°°í¬ ê·¸ë£¹ ë° ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìƒì„±í•©ë‹ˆë‹¤.\nì£¼ì˜í•  ì ì€ ë°°í¬ ê·¸ë£¹ ìƒì„± ì‹œ ì „ ë‹¨ê³„ì—ì„œ ì§„í–‰í•œ IAM ì—­í• ì„ ì…ë ¥í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>\n<br />\n<h3 id=\"5-codedeploy-agent-ì„¤ì¹˜í•˜ê¸°\" style=\"position:relative;\"><a href=\"#5-codedeploy-agent-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\" aria-label=\"5 codedeploy agent ì„¤ì¹˜í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. CodeDeploy agent ì„¤ì¹˜í•˜ê¸°</h3>\n<p>CodeDeploy ì„œë¹„ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ ec2 ì¸ìŠ¤í„´ìŠ¤ ë‚´ì— agent ë¥¼ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤.\nCodeDeploy agent ë¥¼ ì‚¬ìš©í•˜ì—¬, ì´ì „ ë²„ì „ì— ëŒ€í•œ ìŠ¤ëƒ…ìƒ·ì„ ec2 ì— ìë™ ì €ì¥í•¨ìœ¼ë¡œì„œ(ìµœëŒ€ 5ê°œ) ë°°í¬ì— ë¬¸ì œê°€ ìƒê¸¸ ì‹œ ë°±ì—…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>\n<p>ec2 ubuntu 20 ë²„ì „ì— ëŒ€í•´ì„œëŠ” ìë£Œê°€ ë§ì´ ìˆìŠµë‹ˆë‹¤.\nì €ëŠ” ubuntu 22 ë²„ì „ì„ ì‚¬ìš©í•˜ë©° ruby ë²„ì „ìœ¼ë¡œ ì¸í•œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\nì¸ìŠ¤í„´ìŠ¤ê°€ ubuntu 22 ë²„ì „ì´ë¼ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ì¹˜í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p>\n<p>ì°¸ê³  - <a href=\"https://github.com/aws/aws-codedeploy-agent/issues/301#issuecomment-1129912011\">https://github.com/aws/aws-codedeploy-agent/issues/301#issuecomment-1129912011</a></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> update\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt-get</span> <span class=\"token function\">install</span> ruby-full ruby-webrick <span class=\"token function\">wget</span> <span class=\"token parameter variable\">-y</span>\n<span class=\"token builtin class-name\">cd</span> /tmp\n<span class=\"token function\">wget</span> https://aws-codedeploy-ap-northeast-2.s3.ap-northeast-2.amazonaws.com/releases/codedeploy-agent_1.3.2-1902_all.deb\n<span class=\"token function\">mkdir</span> codedeploy-agent_1.3.2-1902_ubuntu22\ndpkg-deb <span class=\"token parameter variable\">-R</span> codedeploy-agent_1.3.2-1902_all.deb codedeploy-agent_1.3.2-1902_ubuntu22\n<span class=\"token function\">sed</span> <span class=\"token string\">'s/Depends:.*/Depends:ruby3.0/'</span> <span class=\"token parameter variable\">-i</span> ./codedeploy-agent_1.3.2-1902_ubuntu22/DEBIAN/control\ndpkg-deb <span class=\"token parameter variable\">-b</span> codedeploy-agent_1.3.2-1902_ubuntu22/\n<span class=\"token function\">sudo</span> dpkg <span class=\"token parameter variable\">-i</span> codedeploy-agent_1.3.2-1902_ubuntu22.deb\nsystemctl list-units <span class=\"token parameter variable\">--type</span><span class=\"token operator\">=</span>service <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> codedeploy\n<span class=\"token function\">sudo</span> <span class=\"token function\">service</span> codedeploy-agent status</code></pre></div>\n<br />\n<h3 id=\"6-github-action-ìŠ¤í¬ë¦½íŠ¸-ì¶”ê°€\" style=\"position:relative;\"><a href=\"#6-github-action-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%B6%94%EA%B0%80\" aria-label=\"6 github action ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. github action ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€</h3>\n<p>github action ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì„¸ ê°œì˜ ìŠ¤í¬ë¦½íŠ¸ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>\n<ol>\n<li>githuc action ìŠ¤í¬ë¦½íŠ¸: CI ë¥¼ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤. s3 ë¡œ ì—…ë¡œë“œ ë˜ê¸°ê¹Œì§€ì˜ ëª¨ë“  ê³¼ì •ì…ë‹ˆë‹¤.</li>\n<li>appspec.yml: ë¹Œë“œ íŒŒì¼ì„ ì–´ëŠ ë””ë ‰í† ë¦¬ë¡œ ì „ì†¡í• ì§€, ë°°í¬ ê³¼ì •ì—ì„œ ì‹¤í–‰í•˜ê³  ì‹¶ì€ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì§€ì •í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.</li>\n<li>after_install.yml: ec2 ì¸ìŠ¤í„´ìŠ¤ê°€ s3 ë¡œ ë¶€í„° ë¹Œë“œ íŒŒì¼ì„ ì „ì†¡ ë°›ì€ í›„ ì‹¤í–‰í•˜ëŠ” ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.</li>\n</ol>\n<blockquote>\n<p>GITHUB - repository -> new workflow -> actions -> set up a workflow yourself</p>\n</blockquote>\n<p>githuc action workflow ì˜ˆì‹œì…ë‹ˆë‹¤. ê° í™˜ê²½ì— ë§ê²Œ ë³€ê²½í•˜ì‹œë©´ ë©ë‹ˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">name: CI\n\non:\n  push:\n    branches: <span class=\"token punctuation\">[</span> main <span class=\"token punctuation\">]</span>\n\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n\n    steps:\n    - name: checkout release\n      uses: actions/checkout@v3\n\n    - name: Package <span class=\"token function\">install</span>\n      run: <span class=\"token function\">yarn</span>\n\n    - name: Build\n      run: <span class=\"token function\">yarn</span> build\n\n    - name: <span class=\"token function\">zip</span> distributions\n      run: <span class=\"token function\">zip</span> <span class=\"token parameter variable\">-r</span> with-eat-build.zip  ./\n\n    - name: AWS configure credentials\n      uses: aws-actions/configure-aws-credentials@v1\n      with:\n        aws-access-key-id: <span class=\"token variable\">${{ secrets.AWS_ACCESS_KEY_ID }</span><span class=\"token punctuation\">}</span>\n        aws-secret-access-key: <span class=\"token variable\">${{ secrets.AWS_SECRET_ACCESS_KEY }</span><span class=\"token punctuation\">}</span>\n        aws-region: ap-northeast-2\n\n    - name: upload to S3\n      run: aws s3 <span class=\"token function\">cp</span> <span class=\"token parameter variable\">--region</span> ap-northeast-2 ./with-eat-build.zip s3://with-eat-bucket/public/\n\n    - name: deploy with AWS codeDeploy\n      run: aws deploy create-deployment\n        --application-name with-eat-deploy\n        --deployment-config-name CodeDeployDefault.OneAtATime\n        --deployment-group-name with-eat-deploy-group\n        --s3-location <span class=\"token assign-left variable\">bucket</span><span class=\"token operator\">=</span>with-eat-bucket,key<span class=\"token operator\">=</span>public/with-eat-build.zip,bundleType<span class=\"token operator\">=</span>zip</code></pre></div>\n<p>appspec.yml ì˜ˆì‹œ</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">version: <span class=\"token number\">0.0</span>\nos: linux\n\nfiles:\n  - source: /\n    destination: /var/www/html\n    overwrite: <span class=\"token function\">yes</span>\n\npermissions:\n  - object: /var/www/html\n    owner: root\n    group: root\n    mode: <span class=\"token number\">755</span>\n\nhooks:\n  AfterInstall:\n    - location: scripts/after_install.sh\n      timeout: <span class=\"token number\">60</span>\n      runas: root</code></pre></div>\n<p>after_install.sh ì˜ˆì‹œ</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">echo \"Project directory\"\ncd /var/www/html;\n\necho \"Project restart\"\npm2 kill &amp;&amp; pm2 start yarn --name yourappname -- start -p 3000 || echo 'Failed pm2 kill';</code></pre></div>\n<br />\n<h2 id=\"ì—ëŸ¬-ë°œìƒì‹œ\" style=\"position:relative;\"><a href=\"#%EC%97%90%EB%9F%AC-%EB%B0%9C%EC%83%9D%EC%8B%9C\" aria-label=\"ì—ëŸ¬ ë°œìƒì‹œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì—ëŸ¬ ë°œìƒì‹œ</h2>\n<p>EC2 + S3 + Codedeploy + githubaction ì´ë ‡ê²Œ ë§ì€ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•˜ë‹¤ë³´ë‹ˆ ë²„ì „, ê¶Œí•œ, ì „ì†¡ ë“± ì—ëŸ¬ê°€ ë°œìƒí• ê²ë‹ˆë‹¤.</p>\n<p>ì œê°€ ì£¼ë¡œ í•´ê²°í•œ ë°©ë²•ì€</p>\n<ol>\n<li>github action ì˜ error log</li>\n<li>ec2 ì¸ìŠ¤í„´ìŠ¤ var/log/aws/codedeploy-agent/codedeploy-agent.log</li>\n</ol>\n<p>ë‘ ë¡œê·¸ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.</p>\n<h3 id=\"ì—ëŸ¬-ì¼€ì´ìŠ¤\" style=\"position:relative;\"><a href=\"#%EC%97%90%EB%9F%AC-%EC%BC%80%EC%9D%B4%EC%8A%A4\" aria-label=\"ì—ëŸ¬ ì¼€ì´ìŠ¤ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì—ëŸ¬ ì¼€ì´ìŠ¤</h3>\n<br />\n<blockquote>\n<p>Error: does not give you permission to perform operations in the following AWS service: AmazonEC2</p>\n</blockquote>\n<ul>\n<li>IAM ì˜ EC2 ì ‘ê·¼ ê¶Œí•œ ë¬¸ì œë¡œ ì¸í•´ S3 -> EC2 ì—…ë¡œë“œê°€ ì•ˆë¨\ní•´ê²° ë°©ë²•: ë‹¤ë¥¸ EC2 ê¶Œí•œì„ ì¤€ë‹¤. ì•ˆë˜ë©´, AmazonEC2FullAccess ì •ì±… ì¶”ê°€</li>\n</ul>\n<blockquote>\n<p>Error: CodeDeploy agent did not find an AppSpec file within the unpacked revision directory at revision-relative path â€œappspec.ymlâ€</p>\n</blockquote>\n<ul>\n<li>ë¹Œë“œíŒŒì¼ ë‚´ì— appspec.yml íŒŒì¼ì„ ì°¾ì§€ ëª»í•´ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•¨</li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#github-action-\">github action ?</a></p>\n<ul>\n<li><a href=\"#%EC%9E%A5%EC%A0%90\">ì¥ì </a></li>\n<li><a href=\"#%EB%8B%A8%EC%A0%90\">ë‹¨ì </a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0\">ì‹œì‘í•˜ê¸°</a></p>\n<ul>\n<li><a href=\"#1-iam-%EC%82%AC%EC%9A%A9%EC%9E%90-%EC%B6%94%EA%B0%80\">1. IAM ì‚¬ìš©ì ì¶”ê°€</a></li>\n<li><a href=\"#2-s3-%EB%B2%84%ED%82%B7-%EC%83%9D%EC%84%B1\">2. S3 ë²„í‚· ìƒì„±</a></li>\n<li><a href=\"#3-iam-%EC%97%AD%ED%95%A0-%EC%83%9D%EC%84%B1\">3. IAM ì—­í•  ìƒì„±</a></li>\n<li><a href=\"#4-codedeploy-%EB%B0%B0%ED%8F%AC-%EA%B7%B8%EB%A3%B9-%EB%B0%8F-%EC%95%A0%ED%94%8C%EB%A6%AC%EC%BC%80%EC%9D%B4%EC%85%98-%EC%83%9D%EC%84%B1\">4. Codedeploy ë°°í¬ ê·¸ë£¹ ë° ì• í”Œë¦¬ì¼€ì´ì…˜ ìƒì„±</a></li>\n<li><a href=\"#5-codedeploy-agent-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\">5. CodeDeploy agent ì„¤ì¹˜í•˜ê¸°</a></li>\n<li><a href=\"#6-github-action-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%B6%94%EA%B0%80\">6. github action ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%97%90%EB%9F%AC-%EB%B0%9C%EC%83%9D%EC%8B%9C\">ì—ëŸ¬ ë°œìƒì‹œ</a></p>\n<ul>\n<li><a href=\"#%EC%97%90%EB%9F%AC-%EC%BC%80%EC%9D%B4%EC%8A%A4\">ì—ëŸ¬ ì¼€ì´ìŠ¤</a></li>\n</ul>\n</li>\n</ul>\n</div>","frontmatter":{"date":"January 01, 2023","title":"aws ec2ì— github action ìœ¼ë¡œ í”„ë¡ íŠ¸ ìë™ ë°°í¬í•˜ê¸°","categories":"ë¸”ë¡œê·¸ ci/cd","author":"vvs-kim","emoji":"ğŸ’»"},"fields":{"slug":"/deploy-with-github-action-and-ec2/"}},"prev":{"id":"f0742e5f-58bf-5028-8df2-0af95d1743f1","html":"<h2 id=\"í”„ë¡ íŠ¸-ê°œë°œìë„-ë„ì»¤-ì´ë¯¸ì§€ë¥¼-ë§Œë“¤ì–´ì•¼-í• ê¹Œ\" style=\"position:relative;\"><a href=\"#%ED%94%84%EB%A1%A0%ED%8A%B8-%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%8F%84-%EB%8F%84%EC%BB%A4-%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%A5%BC-%EB%A7%8C%EB%93%A4%EC%96%B4%EC%95%BC-%ED%95%A0%EA%B9%8C\" aria-label=\"í”„ë¡ íŠ¸ ê°œë°œìë„ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ì–´ì•¼ í• ê¹Œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>í”„ë¡ íŠ¸ ê°œë°œìë„ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ì–´ì•¼ í• ê¹Œ?</h2>\n<h3 id=\"1-ë°±ì—”ë“œ-ê°œë°œìì™€-í˜‘ì—…\" style=\"position:relative;\"><a href=\"#1-%EB%B0%B1%EC%97%94%EB%93%9C-%EA%B0%9C%EB%B0%9C%EC%9E%90%EC%99%80-%ED%98%91%EC%97%85\" aria-label=\"1 ë°±ì—”ë“œ ê°œë°œìì™€ í˜‘ì—… permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ë°±ì—”ë“œ ê°œë°œìì™€ í˜‘ì—…</h3>\n<p>ë°±ì—”ë“œ ê°œë°œìê°€ JAVA, DB ë“±ì„ ë„ì»¤HUB ì— ë°°í¬í•˜ë©´,\ní”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìê°€ í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ë‚´ë ¤ ë°›ê³  ì»´í¬ì¦ˆ í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ì—…í–ˆìŠµë‹ˆë‹¤.\nê·¸ëŸ°ë° ë°±ì—”ë“œ ê°œë°œìë¥¼ ë§ì´ ë§Œë‚˜ë³´ì§€ëŠ” ì•Šì•˜ì§€ë§Œ, ê°™ì´ í˜‘ì—…ì„ í•˜ë‹¤ë³´ë©´\nâ€˜ì œ ìë¦¬ì—ì„œë„ í”„ë¡ íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê³  ì‹¶ì–´ìš”â€™, â€˜í™”ë©´ì„ ë³´ë©´ì„œ í…ŒìŠ¤íŠ¸ í•˜ê³  ì‹¶ì–´ìš”â€™ ë“±ë“± ë°±ì—”ë“œ ê°œë°œìì˜ ìš”êµ¬ ì‚¬í•­ì´ ìƒê²¼ìŠµë‹ˆë‹¤.</p>\n<p>ì²˜ìŒì—ëŠ” ë„ì»¤ê°€ ì™œ í•„ìš”í•œì§€ ëª°ëê¸°ì— ë°±ì—”ë“œ ê°œë°œì ìë¦¬ì—ì„œ</p>\n<ol>\n<li>git clone</li>\n<li>node install</li>\n<li>env íŒŒì¼ ì „ë‹¬</li>\n<li>os ê°€ ë‹¬ë¼ì„œ ìƒê¸°ëŠ” ì˜¤ë¥˜ í•´ê²°â€¦</li>\n<li>ê·¸ë˜ì„œ ì–¸ì œ ë˜ëŠ”ê±°ì£ ..?</li>\n</ol>\n<p>ì´ ëª¨ë“  ê²ƒì„ ì§„í–‰í•˜ë‹¤ê°€ ê²°êµ­ ì„œë²„ë¡œ ë°°í¬í•´ì„œ í™•ì¸ì„ í–ˆì—ˆìŠµë‹ˆë‹¤.\në§Œì•½ì— nextjs ë¥¼ ë„ì»¤ ì´ë¯¸ì§€ë¡œ ë§Œë“¤ì—ˆë‹¤ë©´, ì´ëŸ° ë¶ˆí¸í•¨ì€ ì—†ì—ˆì„ ê²ë‹ˆë‹¤.</p>\n<br />\n<h3 id=\"2-ìš´ì˜í™˜ê²½ì˜-ë¹Œë“œíŒŒì¼-ë²„ì „-ê´€ë¦¬\" style=\"position:relative;\"><a href=\"#2-%EC%9A%B4%EC%98%81%ED%99%98%EA%B2%BD%EC%9D%98-%EB%B9%8C%EB%93%9C%ED%8C%8C%EC%9D%BC-%EB%B2%84%EC%A0%84-%EA%B4%80%EB%A6%AC\" aria-label=\"2 ìš´ì˜í™˜ê²½ì˜ ë¹Œë“œíŒŒì¼ ë²„ì „ ê´€ë¦¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. ìš´ì˜í™˜ê²½ì˜ ë¹Œë“œíŒŒì¼ ë²„ì „ ê´€ë¦¬</h3>\n<p>ì´ì „ í”„ë¡œì íŠ¸ì—ì„œ CI/CD ë¥¼ ì ìš©í•˜ê¸° ìœ„í•´ jenkins, github-action ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤.\nbranch ë¥¼ í†µí•©í•˜ë©´ ìë™ìœ¼ë¡œ ë°°í¬ê°€ ëœë‹¤ëŠ” ì‚¬ì‹¤ì€ ì¥ì ì´ì—ˆìŠµë‹ˆë‹¤.\nê·¸ëŸ¬ë‚˜ ë°°í¬ í›„ ìš´ì˜í™˜ê²½ì—ì„œ ì—ëŸ¬ê°€ ë°œìƒí•˜ê±°ë‚˜ ì‹¤ìˆ˜ë¥¼ ë°œê²¬í–ˆì„ ë•Œ,</p>\n<p>ì•„ë¬´ëŸ° ì¤€ë¹„ë¥¼ í•˜ì§€ ì•Šì•˜ë”ë¼ë©´</p>\n<ol>\n<li>ì›ì¸ ì²´í¬(ë˜ëŠ” ë¡¤ë°±)</li>\n<li>package install, build</li>\n<li>ì„œë²„ë¡œ ë¹Œë“œ íŒŒì¼ ì „ì†¡</li>\n</ol>\n<p>ì´ ëª¨ë“  ê²ƒì„ ì§„í–‰í•´ì•¼ í•˜ëŠ”ë°, 2~3ë¶„ì˜ ì‹œê°„ì´ ê±¸ë¦½ë‹ˆë‹¤.\nì½”ë“œ ì–‘ì´ ë§ìœ¼ë©´ í›¨ì”¬ ë” ì˜¤ë˜ ê±¸ë¦´ ê²ë‹ˆë‹¤.\nì´ ì‹œê°„ë™ì•ˆ ì‚¬ìš©ìê°€ ì˜¤ë¥˜ í™”ë©´ì„ ë³´ì§€ ì•Šê¸° ìœ„í•´ì„œëŠ”\në¹Œë“œ íŒŒì¼ì„ ë²„ì „ ê´€ë¦¬í•˜ì—¬ ë¹ ë¥¸ ì‹œê°„ë‚´ë¡œ ì „ì†¡ì„ ë°›ì•„ì„œ ì¬ì‹¤í–‰ í•˜ëŠ” ë°©ë²•ì´ ìˆìŠµë‹ˆë‹¤.\n<strong>ë„ì»¤ë¥¼ ì‚¬ìš©í•˜ë©´ ìš´ì˜í™˜ê²½ì— ë§ëŠ” ì´ë¯¸ì§€ë¥¼ ë°°í¬í•˜ì—¬ ë²„ì „ ë³„ë¡œ ë‚´ë ¤ë°›ì•„ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</strong></p>\n<br />\n<h2 id=\"ì‹œì‘í•˜ê¸°\" style=\"position:relative;\"><a href=\"#%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0\" aria-label=\"ì‹œì‘í•˜ê¸° permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ì‹œì‘í•˜ê¸°</h2>\n<p>ì œê°€ ê¶ê¸ˆí–ˆê³ , ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•œ ë¶€ë¶„ì„ ì‘ì„±í•œ ê¸€ì…ë‹ˆë‹¤.\nnextjs ë¡œ ì‘ì„±ëœ ì½”ë“œë¥¼ ë°°í¬í•˜ê¸° ìœ„í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>\n<h3 id=\"ë¡œì»¬-ë‚´ì˜-ì €ì¥íŒŒì¼\" style=\"position:relative;\"><a href=\"#%EB%A1%9C%EC%BB%AC-%EB%82%B4%EC%9D%98-%EC%A0%80%EC%9E%A5%ED%8C%8C%EC%9D%BC\" aria-label=\"ë¡œì»¬ ë‚´ì˜ ì €ì¥íŒŒì¼ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë¡œì»¬ ë‚´ì˜ ì €ì¥íŒŒì¼</h3>\n<h4 id=\"1-dockerfile-ì‘ì„±\" style=\"position:relative;\"><a href=\"#1-dockerfile-%EC%9E%91%EC%84%B1\" aria-label=\"1 dockerfile ì‘ì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Dockerfile ì‘ì„±</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">FROM node:16.17.0-alpine\n\nRUN <span class=\"token function\">mkdir</span> <span class=\"token parameter variable\">-p</span> /app\nWORKDIR /app\nADD ./ /app\n\nRUN <span class=\"token function\">npm</span> <span class=\"token function\">install</span> <span class=\"token parameter variable\">-g</span> pm2\n\nCMD <span class=\"token punctuation\">[</span><span class=\"token string\">\"pm2-runtime\"</span>, <span class=\"token string\">\"start\"</span>, <span class=\"token string\">\"ecosystem.config.js\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>ë¹Œë“œí•œ Next íŒŒì¼ì„ ë„ì»¤ ì´ë¯¸ì§€ë¡œ ìƒì„±í•˜ê³ , pm2 ë¡œ ì‹¤í–‰í•˜ê¸° ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ì…ë‹ˆë‹¤.\nalpine: ì‹¤í–‰ì— í•„ìš”í•œ ìµœì†Œì˜ ì´ë¯¸ì§€ ë²„ì „ì…ë‹ˆë‹¤. ì‚¬ìš©í•˜ì§€ ì•Šì„ ì‹œ ì´ë¯¸ì§€ ìš©ëŸ‰ì´ ì»¤ì ¸ì„œ ë°°í¬ ì‹œê°„ì´ ì¦ê°€í•©ë‹ˆë‹¤.</p>\n<h4 id=\"2-ecosystemconfigjs-ì‘ì„±\" style=\"position:relative;\"><a href=\"#2-ecosystemconfigjs-%EC%9E%91%EC%84%B1\" aria-label=\"2 ecosystemconfigjs ì‘ì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. ecosystem.config.js ì‘ì„±</h4>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">apps</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token literal-property property\">name</span><span class=\"token operator\">:</span> <span class=\"token string\">'test'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">cwd</span><span class=\"token operator\">:</span> <span class=\"token string\">'./'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token literal-property property\">script</span><span class=\"token operator\">:</span> <span class=\"token string\">'yarn start'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>name: Pm2ì—ì„œ ì‹¤í–‰í•˜ëŠ” ì•± ì´ë¦„\ncwd: ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•  ìœ„ì¹˜</p>\n<h4 id=\"3-dockerignore-ì‘ì„±\" style=\"position:relative;\"><a href=\"#3-dockerignore-%EC%9E%91%EC%84%B1\" aria-label=\"3 dockerignore ì‘ì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. .dockerignore ì‘ì„±</h4>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">.git\n.github\n.vscode\n.husky\n\nscripts</code></pre></div>\n<p>ì´ë¯¸ì§€ ìš©ëŸ‰ì„ ìµœì†Œí™” í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤.\në„ì»¤ ë¹Œë“œ ì‹œ ì‚¬ìš©ë˜ì§€ ì•Šì„ í´ë”, íŒŒì¼ì„ ì ì–´ì¤ë‹ˆë‹¤.</p>\n<h4 id=\"4-docker-build-push-ì‰˜-ìŠ¤í¬ë¦½íŠ¸-ì‘ì„±\" style=\"position:relative;\"><a href=\"#4-docker-build-push-%EC%89%98-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%9E%91%EC%84%B1\" aria-label=\"4 docker build push ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. docker build, push ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\">##!/bin/bash</span>\n<span class=\"token assign-left variable\">repository</span><span class=\"token operator\">=</span>testname/testrepo\n<span class=\"token assign-left variable\">os</span><span class=\"token operator\">=</span>linux/amd64\n\n<span class=\"token comment\">### ì—…ë°ì´íŠ¸ ë²„ì „ ì…ë ¥</span>\n<span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-p</span> <span class=\"token string\">\"Enter the version: \"</span> version\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"=>>> docker build front images...\"</span>\n<span class=\"token function\">docker</span> build <span class=\"token parameter variable\">-f</span> Dockerfile <span class=\"token parameter variable\">--platform</span> <span class=\"token variable\">$os</span> <span class=\"token parameter variable\">-t</span> <span class=\"token variable\">$repository</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$version</span> <span class=\"token builtin class-name\">.</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"=>>> docker push front container....\"</span>\n<span class=\"token function\">docker</span> push <span class=\"token variable\">$repository</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$version</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸš€ success <span class=\"token variable\">$version</span> push\"</span></code></pre></div>\n<p>ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë²„ì „ ë³„ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì…ë‹ˆë‹¤.\nì‚¬ìš©ìëŠ” next ë¹Œë“œ í›„ ì‰˜ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ ë©ë‹ˆë‹¤.</p>\n<p>os: ìš´ì˜ì„œë²„ë¥¼ ìƒì„±ì‹œ x86 í”„ë¡œì„¸ì„œë¥¼ ì ìš©í–ˆë‹¤ë©´, ê·¸ì— ë§ê²Œ ë¹Œë“œí•˜ê¸° ìœ„í•´ ë³€ìˆ˜ë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.\nread -p: ì…ë ¥ë°›ì€ ë²„ì „ìœ¼ë¡œ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê³  HUBì— í‘¸ì‹œí•©ë‹ˆë‹¤.</p>\n<br />\n<h3 id=\"ìš´ì˜ì„œë²„-ë‚´ì˜-ì €ì¥íŒŒì¼\" style=\"position:relative;\"><a href=\"#%EC%9A%B4%EC%98%81%EC%84%9C%EB%B2%84-%EB%82%B4%EC%9D%98-%EC%A0%80%EC%9E%A5%ED%8C%8C%EC%9D%BC\" aria-label=\"ìš´ì˜ì„œë²„ ë‚´ì˜ ì €ì¥íŒŒì¼ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ìš´ì˜ì„œë²„ ë‚´ì˜ ì €ì¥íŒŒì¼</h3>\n<h4 id=\"1-docker-composeyml-ì‘ì„±\" style=\"position:relative;\"><a href=\"#1-docker-composeyml-%EC%9E%91%EC%84%B1\" aria-label=\"1 docker composeyml ì‘ì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. docker-compose.yml ì‘ì„±</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">version: <span class=\"token string\">'3'</span>\nservices:\n    node:\n        container_name: test-front\n        image: testname/testrepo:1.0\n        ports:\n            - <span class=\"token string\">'3000:3000'</span>\n        restart: always\n        environment:\n            TZ: Asia/Seoul</code></pre></div>\n<br />\n<h4 id=\"2-docker-pull-compose-ì‰˜-ìŠ¤í¬ë¦½íŠ¸-ì‘ì„±\" style=\"position:relative;\"><a href=\"#2-docker-pull-compose-%EC%89%98-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%9E%91%EC%84%B1\" aria-label=\"2 docker pull compose ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„± permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. docker pull, compose ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±</h4>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\">##!/bin/bash</span>\n<span class=\"token assign-left variable\">repository</span><span class=\"token operator\">=</span>testname/testrepo\n\n<span class=\"token comment\">## ì—…ë°ì´íŠ¸ ë²„ì „ ì…ë ¥</span>\n<span class=\"token builtin class-name\">read</span> <span class=\"token parameter variable\">-p</span> <span class=\"token string\">\"Enter the version: \"</span> version\n<span class=\"token function\">sed</span> <span class=\"token parameter variable\">-i</span> <span class=\"token string\">\"5s/.*/        image: testname\\/testrepo:<span class=\"token variable\">$version</span>/\"</span> docker-compose.yml\n\n<span class=\"token comment\">## ì—…ë°ì´íŠ¸ ë²„ì „ ë‹¤ìš´ë¡œë“œ</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"=>>> docker stop front container....\"</span>\n<span class=\"token function\">docker</span> stop <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">docker</span> <span class=\"token function\">ps</span> <span class=\"token parameter variable\">-q</span> <span class=\"token parameter variable\">-af</span> <span class=\"token string\">\"name=testrepo\"</span><span class=\"token variable\">)</span></span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"=>>> docker remove front container....\"</span>\n<span class=\"token function\">docker</span> <span class=\"token function\">rm</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">docker</span> <span class=\"token function\">ps</span> <span class=\"token parameter variable\">-q</span> <span class=\"token parameter variable\">-af</span> <span class=\"token string\">\"name=testrepo\"</span><span class=\"token variable\">)</span></span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"=>>> docker pull dev version.....\"</span>\n<span class=\"token function\">docker</span> pull <span class=\"token variable\">$repository</span><span class=\"token builtin class-name\">:</span><span class=\"token variable\">$version</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"=>>> docker compose...\"</span>\n<span class=\"token function\">docker-compose</span> up <span class=\"token parameter variable\">-d</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"=>>> docker remove previous image...\"</span>\n<span class=\"token function\">docker</span> rmi <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">docker</span> images <span class=\"token parameter variable\">-f</span> <span class=\"token string\">\"dangling=true\"</span> <span class=\"token parameter variable\">-q</span><span class=\"token variable\">)</span></span>\n\n<span class=\"token comment\">## ì €ì¥ê³µê°„ ìš©ëŸ‰, ì—…ë°ì´íŠ¸ í™•ì¸</span>\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\033\">\\033</span>[32mcheck storage<span class=\"token entity\" title=\"\\033\">\\033</span>[0m\"</span>\n<span class=\"token function\">df</span> <span class=\"token parameter variable\">-hs</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"<span class=\"token entity\" title=\"\\033\">\\033</span>[32mcheck deploy<span class=\"token entity\" title=\"\\033\">\\033</span>[0m\"</span>\n<span class=\"token function\">docker</span> <span class=\"token function\">ps</span>\n\n<span class=\"token builtin class-name\">echo</span> <span class=\"token string\">\"ğŸš€ success <span class=\"token variable\">$version</span> deploy\"</span></code></pre></div>\n<ol>\n<li>ì‚¬ìš©ìê°€ pull ë°›ì„ ì´ë¯¸ì§€ ë²„ì „ì„ ì…ë ¥</li>\n<li>docker-compose.yml íŒŒì¼ ë‚´ì˜ ë²„ì „ì´ ìˆ˜ì •ë¨</li>\n<li>ì‹¤í–‰ë˜ê³  ìˆëŠ” ì»¨í…Œì´ë„ˆ ì¤‘ì§€ ë° ì‚­ì œ</li>\n<li>ì´ë¯¸ì§€ Pull ë°›ì€ í›„ ì»¨í…Œì´ë„ˆ ì‹¤í–‰</li>\n</ol>\n<p>sed -i: íŠ¹ì • íŒŒì¼ ë‚´ì˜ ë¬¸ìì—´ì„ ìˆ˜ì •í•˜ê¸° ìœ„í•´ì„œ ì‚¬ìš©</p>\n<br />\n<h2 id=\"ë¶€ì¡±í•œ-ì \" style=\"position:relative;\"><a href=\"#%EB%B6%80%EC%A1%B1%ED%95%9C-%EC%A0%90\" aria-label=\"ë¶€ì¡±í•œ ì  permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ë¶€ì¡±í•œ ì </h2>\n<p>ì‚¬ìš©ìëŠ”</p>\n<ol>\n<li>ì‰˜ ìŠ¤í¬ë¦½íŠ¸(ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ê³  HUBì— í‘¸ì‹œí•¨) ì‹¤í–‰ í›„ ë²„ì „ ì…ë ¥</li>\n<li>ìš´ì˜ ì„œë²„ì— ì ‘ì†</li>\n<li>ì‰˜ ìŠ¤í¬ë¦½íŠ¸(ë„ì»¤ ì´ë¯¸ì§€ë¥¼ pull ë°›ê³  ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•¨) ì‹¤í–‰ í›„ ë²„ì „ ì…ë ¥</li>\n</ol>\n<p>ì´ëŸ¬í•œ ê°„ë‹¨í•œ í”Œë¡œìš°ë¡œ ì´ë¯¸ì§€ë¥¼ ë°°í¬ ë° ë²„ì „ ê´€ë¦¬ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nê·¸ë ‡ì§€ë§Œ <strong>ë¹Œë“œí•˜ëŠ” ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¬ê³ , ê·¸ ì‹œê°„ì„ ê¸°ë‹¤ë ¤ì„œ ì„œë²„ì— ì ‘ì†í•œë‹¤ëŠ” ê²ƒì€ ë¶ˆí¸í•œ ì¼</strong>ì´ë¼ê³  ìƒê°ì´ ë“­ë‹ˆë‹¤.\n1~3ë²ˆ ê³¼ì •ì„ ìë™í™”í•˜ê¸° ìœ„í•´ githun-action ìœ¼ë¡œ CI/CD ë¥¼ êµ¬ì¶•í•´ë³´ë ¤ í•©ë‹ˆë‹¤.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#%ED%94%84%EB%A1%A0%ED%8A%B8-%EA%B0%9C%EB%B0%9C%EC%9E%90%EB%8F%84-%EB%8F%84%EC%BB%A4-%EC%9D%B4%EB%AF%B8%EC%A7%80%EB%A5%BC-%EB%A7%8C%EB%93%A4%EC%96%B4%EC%95%BC-%ED%95%A0%EA%B9%8C\">í”„ë¡ íŠ¸ ê°œë°œìë„ ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ë§Œë“¤ì–´ì•¼ í• ê¹Œ?</a></p>\n<ul>\n<li><a href=\"#1-%EB%B0%B1%EC%97%94%EB%93%9C-%EA%B0%9C%EB%B0%9C%EC%9E%90%EC%99%80-%ED%98%91%EC%97%85\">1. ë°±ì—”ë“œ ê°œë°œìì™€ í˜‘ì—…</a></li>\n<li><a href=\"#2-%EC%9A%B4%EC%98%81%ED%99%98%EA%B2%BD%EC%9D%98-%EB%B9%8C%EB%93%9C%ED%8C%8C%EC%9D%BC-%EB%B2%84%EC%A0%84-%EA%B4%80%EB%A6%AC\">2. ìš´ì˜í™˜ê²½ì˜ ë¹Œë“œíŒŒì¼ ë²„ì „ ê´€ë¦¬</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%8B%9C%EC%9E%91%ED%95%98%EA%B8%B0\">ì‹œì‘í•˜ê¸°</a></p>\n<ul>\n<li>\n<p><a href=\"#%EB%A1%9C%EC%BB%AC-%EB%82%B4%EC%9D%98-%EC%A0%80%EC%9E%A5%ED%8C%8C%EC%9D%BC\">ë¡œì»¬ ë‚´ì˜ ì €ì¥íŒŒì¼</a></p>\n<ul>\n<li><a href=\"#1-dockerfile-%EC%9E%91%EC%84%B1\">1. Dockerfile ì‘ì„±</a></li>\n<li><a href=\"#2-ecosystemconfigjs-%EC%9E%91%EC%84%B1\">2. ecosystem.config.js ì‘ì„±</a></li>\n<li><a href=\"#3-dockerignore-%EC%9E%91%EC%84%B1\">3. .dockerignore ì‘ì„±</a></li>\n<li><a href=\"#4-docker-build-push-%EC%89%98-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%9E%91%EC%84%B1\">4. docker build, push ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%9A%B4%EC%98%81%EC%84%9C%EB%B2%84-%EB%82%B4%EC%9D%98-%EC%A0%80%EC%9E%A5%ED%8C%8C%EC%9D%BC\">ìš´ì˜ì„œë²„ ë‚´ì˜ ì €ì¥íŒŒì¼</a></p>\n<ul>\n<li><a href=\"#1-docker-composeyml-%EC%9E%91%EC%84%B1\">1. docker-compose.yml ì‘ì„±</a></li>\n<li><a href=\"#2-docker-pull-compose-%EC%89%98-%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%8A%B8-%EC%9E%91%EC%84%B1\">2. docker pull, compose ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EB%B6%80%EC%A1%B1%ED%95%9C-%EC%A0%90\">ë¶€ì¡±í•œ ì </a></p>\n</li>\n</ul>\n</div>","frontmatter":{"date":"February 19, 2023","title":"docker, nextjs ì´ë¯¸ì§€ ë°°í¬í•˜ê¸° - 1 (+ì‰˜ ìŠ¤í¬ë¦½íŠ¸)","categories":"ë¸”ë¡œê·¸ ci/cd docker","author":"vvs-kim","emoji":"ğŸ’»"},"fields":{"slug":"/nextjs-deploy-with-docker-1/"}},"site":{"siteMetadata":{"siteUrl":"https://vvs-kim.github.io","comments":{"utterances":{"repo":"vvs-kim/vvs-kim.github.io"}}}}},"pageContext":{"slug":"/ubuntu-connect-with-root-credential/","nextSlug":"/deploy-with-github-action-and-ec2/","prevSlug":"/nextjs-deploy-with-docker-1/"}},"staticQueryHashes":["1073350324","1956554647","2938748437"]}